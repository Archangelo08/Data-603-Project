---
title: "Data 603 Project"
author: "Ahuchogu, Divine | Ouano, Archangelo - 30235358"
date: "2023-11-28"
output: pdf_document
header-includes: \usepackage{fvextra} \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Chapter 1: Introduction

1.1 Motivation

1.1.1 Context
* Clearly state the context and applied domain of your project

1.1.2 Problem
* What problem are we going to address?

1.2 Objectives

1.2.1 Overview
* What is the overall intent of the project?

1.2.2 Goals & Research Questions
* Clearly state each of your data/visual analytics goals and research questions for data modelling. What are your expectations? Why is this project important to you?


# Chapter 2: Methodology

2.1 Data
* Briefly describe the data set, source, how it was collected, number of attributes and a brief description of each attribute

2.2 Approach
* What approach are we going to try to address your problems? Why do we think it will work well?

2.3 Workflow
* What steps (workflow task list) are required? Which of these steps is particularly hard? What to do if the hard steps don't work out?

2.4 Workload Distribution
* Briefly describe the group member's workload distribution and responsibilities


# Chapter 3: Main Results of the Analysis

3.1 Results
* What do my results indicate? Do you have any unexpected results?

# Chapter 4: Conclusion and Discussion

4.1 Approach
* Overall, is the approach we took promising? Please elaborate. What different approach or variant of this approach is better?

4.2 Future Work
What should follow-up work be done next?

```{r}
library(readr)
# Load the dataset from water.csv
concretedata <- read_csv("Concrete_Data_file.csv")


head(concretedata, 6)
tail(concretedata, 5)

```


```{r}

# Check the structure of the data
#str(concretedata)


# Fit a multiple regression model
fullmodel <- lm(Concrete_compressive_strength ~ Cement + Blast_Furnace_Slag + Fly_Ash + Water + Superplasticizer + Coarse_Aggregate + Fine_Aggregate + Age_by_day, data = concretedata)

summary(fullmodel)

```

```{r}

library(olsrr)
#To show the best model
stepfullmodel=ols_step_both_p(fullmodel, pent =0.05, prem =0.1, details=FALSE)
summary(stepfullmodel$model)


```



```{r}
# Load necessary libraries
library(ggplot2)
library(car)

# Extract residuals from the best model
residuals_bestmodel <- residuals(bestmodel)

# 1. Linearity Assumption: Residual plots
par(mfrow=c(2,2))
plot(bestmodel)

ggplot(data = concretedata, aes(sample=bestmodel$residuals)) + stat_qq() + stat_qq_line()

```


```{r}
library(mctest)
library(lmtest)
library(MASS)

cat("H0: The population sample follows a normal distribution.
    \n HA: The population sample does not follow a normal distribution. \n")

# 2. Normality Assumption: Shapiro-Wilk normality test
shapiro.test(residuals(bestmodel))

cat(" Given that p-value = 0.006998 which tells us that the residuals are not perfectly normally distributed, we reject the null hypothesis at 0.05 significant level.")


```


```{r}

cat("Null Hypothesis: heteroscedasticity is not present
\n Alternative Hypothesis: Heteroscedasticity is present \n")

# 3. Equal Variance Assumption (Heteroscedasticity): Breusch-Pagan test
bptest(bestmodel)

```

```{r}
#quadmodel <- lm(Concrete_compressive_strength ~ Cement + I(Cement^2) + Blast_Furnace_Slag + Fly_Ash + Water + Superplasticizer + Age_by_day, data = concretedata)
#summary(quadmodel)$adj.r.squared
#summary(quadmodel)

#bptest(quadmodel)

bc=boxcox(bestmodel,lambda=seq(-1,1))
 
bestlambda=bc$x[which(bc$y==max(bc$y))]
bestlambda

bcmodel = lm((((Concrete_compressive_strength ^ 0.6767677)-1)/0.6767677) ~ Cement + Blast_Furnace_Slag + Fly_Ash + Water + Superplasticizer + Age_by_day, data = concretedata) 

summary(bcmodel)

bptest(bcmodel)


# Extract residuals from the best model
residuals_bcmodel <- residuals(bcmodel)

# 1. Linearity Assumption: Residual plots
par(mfrow=c(2,2))
plot(bcmodel)

shapiro.test(residuals(bcmodel))

ggplot(data = concretedata, aes(sample=bcmodel$residuals)) + stat_qq() + stat_qq_line()

```

```{r}
#cubic <- lm(Concrete_compressive_strength ~ Cement + I(Cement^2) + I(Cement^3)+ Blast_Furnace_Slag + Fly_Ash + Water + Superplasticizer + Age_by_day, data = concretedata)

#summary(cubic)$adj.r.squared
#summary(cubic)

#bptest(cubic)

```


```{r}


```


```{r}

```

```{r}


```

```{r}



```


```{r}



```


```{r}


```



```{r}


```


```{r}


```


```{r}


```

```{r}

# Create interaction terms





```

```{r}
#individual t-test
coef_test <- summary(bestmodel)$coefficients[, c("Estimate", "Std. Error", "t value", "Pr(>|t|)")]
coef_test

```

```{r}

#bptest




```

```{r}




```

```{r}

# 4. Multicollinearity: Variance Inflation Factors (VIF)


```


```{r}

# 5. Outliers: Cookâ€™s distance and leverage


```






